# **Pricing European Options Using Advanced Financial Models and Numerical Methods**

## **Objective**
The goal of this project is to price European options using various financial models and numerical methods, analyze the volatility smile and surface, and compare the convergence speeds of different Monte Carlo simulation techniques. The key steps include:

1. **Black-Scholes Model**:
   - Implement the Black-Scholes formula to price European call and put options.
   - Analyze the sensitivity of option prices to model parameters (Greeks).

2. **Monte Carlo Simulations**:
   - Simulate asset price paths using **Geometric Brownian Motion (GBM)**.
   - Discretize the GBM using:
     - **Euler-Maruyama Stochastic Scheme**.
     - **Milstein Scheme** (for improved accuracy).
   - Use the simulated paths to estimate option prices under the risk-neutral measure.
   - Compare the convergence speeds of the Euler-Maruyama and Milstein schemes.

3. **Heston Model**:
   - Implement the **Heston Stochastic Volatility Model** to simulate asset price and volatility paths.
   - Use Monte Carlo simulations to price European options under the Heston model.
   - Assume that the market price of the option is equal to the price simulated by the Heston model.

4. **Volatility Smile and Surface**:
   - Plot the **volatility smile** by calculating implied volatilities for options with different strike prices.
   - Generate the **volatility surface** by extending the analysis to options with different maturities.
   - Compare the volatility smile and surface generated by the Heston model with those implied by the Black-Scholes model.

5. **Convergence Analysis**:
   - Compare the convergence speeds of the Monte Carlo methods (Euler-Maruyama and Milstein) for both GBM and Heston models.
   - Analyze the computational efficiency and accuracy of each method.

6. **Variance Reduction Techniques**:
   - Implement **antithetic variates** and **control variates** to reduce the variance of Monte Carlo estimates.
   - Compare the effectiveness of these techniques in improving the accuracy of option pricing.

---

## **Key Components**

### 1. **Black-Scholes Model**
   - Use the Black-Scholes formula:
     ```
     C = S_0 N(d_1) - K e^(-rT) N(d_2),
     ```
     where:
     ```
     d_1 = [ln(S_0 / K) + (r + σ^2 / 2)T] / [σ √T],
     d_2 = d_1 - σ √T.
     ```
   - Compute the Greeks (Delta, Gamma, Vega, etc.) to understand the sensitivity of option prices to model inputs.

### 2. **Monte Carlo Simulations**
   - **Geometric Brownian Motion (GBM)**:
     ```
     dS_t = r S_t dt + σ S_t dW_t,
     ```
     where `r` is the risk-free rate, `σ` is the volatility, and `W_t` is a Wiener process.
   - **Discretization Schemes**:
     - **Euler-Maruyama**:
       ```
       S_{t+Δt} = S_t + r S_t Δt + σ S_t ΔW_t.
       ```
     - **Milstein** (for improved accuracy):
       ```
       S_{t+Δt} = S_t + r S_t Δt + σ S_t ΔW_t + (1/2) σ^2 S_t (ΔW_t^2 - Δt).
       ```
   - Simulate multiple paths and compute the option price as the discounted expected payoff:
     ```
     Price = e^(-rT) * E[max(S_T - K, 0)]  (for a call option).
     ```

### 3. **Heston Model**
   - Simulate the joint dynamics of the asset price `S_t` and its volatility `v_t`:
     ```
     dS_t = r S_t dt + √v_t S_t dW_t^1,
     dv_t = κ (θ - v_t) dt + ξ √v_t dW_t^2,
     ```
     where:
     - `κ` is the mean-reversion rate,
     - `θ` is the long-term volatility,
     - `ξ` is the volatility of volatility,
     - `W_t^1` and `W_t^2` are correlated Wiener processes with correlation `ρ`.
   - Use Monte Carlo simulations to estimate option prices under the Heston model.

### 4. **Volatility Smile and Surface**
   - Compute implied volatilities for options with different strike prices and maturities.
   - Plot the **volatility smile** (implied volatility vs. strike price) and the **volatility surface** (implied volatility vs. strike price and maturity).
   - Compare the results from the Heston model with those from the Black-Scholes model.

### 5. **Convergence Analysis**
   - Compare the convergence speeds of the Euler-Maruyama and Milstein schemes for both GBM and Heston models.
   - Analyze the trade-off between computational efficiency and accuracy for each method.

### 6. **Variance Reduction Techniques**
   - **Antithetic Variates**:
     - For each random path generated, create a corresponding antithetic path by reversing the sign of the random increments.
     - The antithetic variates estimator is given by:
       ```latex
       \hat{Y}_{\text{AV}} = \frac{1}{2} (Y + Y_{\text{antithetic}}),
       ```
       where `Y` is the original estimate and `Y_{\text{antithetic}}` is the estimate from the antithetic path.
     - This technique reduces variance by introducing negative correlation between paired samples.

   - **Control Variates**:
     - Use a control variate `C` (a random variable with known expectation) to adjust the Monte Carlo estimate.
     - The control variates estimator is given by:
       ```latex
       \hat{Y}_{\text{CV}} = Y - \beta (C - \mathbb{E}[C]),
       ```
       where `β` is a coefficient chosen to minimize the variance of the estimator.
     - Common choices for `C` include the underlying asset price or a related derivative with a known price.

   - Compare the effectiveness of antithetic variates and control variates in reducing the variance of Monte Carlo estimates.

---

## **Tools and Libraries**
- **Programming Language**: Python
- **Libraries**:
  - `numpy` for numerical computations.
  - `scipy` for statistical functions (e.g., cumulative distribution function for Black-Scholes).
  - `matplotlib` and `seaborn` for plotting volatility smiles and surfaces.
  - `quantlib` or `pyfin` for advanced financial modeling (optional).

---

## **Expected Outcomes**
1. Accurate pricing of European options using the Black-Scholes model and Monte Carlo simulations.
2. Visualization of the volatility smile and surface under the Heston model.
3. Comparative analysis of the convergence speeds of Euler-Maruyama and Milstein schemes.
4. Implementation and evaluation of variance reduction techniques (antithetic variates and control variates).
5. Insights into the computational efficiency and accuracy of different numerical methods.

---

## **Repository Structure**
